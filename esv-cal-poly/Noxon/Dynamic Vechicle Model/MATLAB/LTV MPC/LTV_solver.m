% Author: Nikola Noxon
% California Polytehnic State University
% email: nikolanoxon@gmail.com
% Oct 2011; Last revision: 1-12-16

%------------- BEGIN CODE --------------

%--------------------------------
% SETUP
%--------------------------------

% set Independent Variables
x_d = 10;
y_d = 0;
phi = 0;
psi = 0;
psi_d = 0; 
phi_d = 0;

delta = 10; % rad

% set Constants
tau = 1; % sec
g   = 9.81; % m/s^2

%--------------------------------
% TRAXAS SLASH PHYSICAL VARIABLES
%--------------------------------
% Longitudinal distance between the center of tire and vehicle center of mass
l_fs =0.212; % m			 
l_rs =0.126; % m		

% Front and rear track width
t_f =0.307; % m
t_r =0.307; % m

% Distance between ground and static roll center
h_f =0.021; % m				
h_r = 0.045; % m

% Height of sprung mass CG above ground
h_cgs = 0.107; % m

% Height of front/rear unsprung mass CG above ground
h_cguf = 0.051; % m
h_cgur =0.051; % m

% Total vehicle mass
M =3.116; % kg;

% Front/Rear unsprung mass
M_uf =0.342; % kg
M_ur =0.329; % kg

% Moments of inertia of sprung mass about its CG
I_xxs = 0.005; % g-mm2
I_yys = 0.043; % g-mm2
I_zzs = 0.045; % g-mm2

% Products of inertia of sprung mass about its CG
I_xys = 0.0006; % g-mm2
I_xzs = 0.0009; % g-mm2
I_yzs = 0.00006; % g-mm2

% Moment of inertia of wheel about its spin axis
I_trf =  0.0002; % kg-m^2
I_tlf =  0.0002; % kg-m^2
I_trr =  0.0002; % kg-m^2
I_tlr =  0.0002; % kg-m^2

% Front/rear spring stiffness
% to be calculated
K_spf = 0; % N/m
K_spr = 0; % N/m

% Front/rear spring damping 
% to be calculated
B_f = 0; % N-s/m
B_r = 0; % N-s/m
 
% Front/Rear anti-roll bar stiffness
K_rf = 0; % N-m/rad
K_rr = 0; % N-m/rad
 
% Steering-to-wheel angle ratio
% to be calculated
K_sr = 1;

% Tire Width
t_wid =0.044; % m

% Tire Radius
t_rad =0.054; % m

% Normalized Tire properties
varx = [...
    0.0, 0.0;...
    0.1, 0.6;...
    0.15, 0.85;...
    1.0, 0.4]; %slip curve coordinates (rad, mu)
vary = [...
    0.0, 0.0;...
    0.08, 0.4;...
    0.15, 0.6;...
    0.3, 0.8;...
    1.0, 0.4]; %slip curve coordinates (rad, mu) 
varM = [...
    0.0, 0.0;...
    0.1, 0.0005;...
    0.3, 0.00025;...
    1.0, 0.0]; %slip angle (slip-angle, Moment-arm)

%----------------------
% CONSTANT CALCULATED PARAMETERS
%----------------------
% Roll stiffness
K_phif = 0.766*K_spf*t_f^2/2 + K_rf;
K_phir = 0.827*K_spr*t_r^2/2 + K_rr;
K_phi = (K_phif + K_phir); 

% Roll damping
B_phif = 0.766*B_f*t_f^2/2; % Nm-s/rad
B_phir = 0.827*B_r*t_r^2/2; % Nm-s/rad
B_phi = (B_phif + B_phir); % Nm-s/rad
 
% Moment of inertia of unsprung front/rear mass about their CoG
I_zzuf = M_uf*(t_f/2)^2;
I_zzur = M_ur*(t_r/2)^2;

% Wheelbase
L = l_fs + l_rs;

% Sprung Mass
M_s = M - M_uf - M_ur;

% Longitudinal distance from sprung CG to total mass CG
l_cgs = (M_ur*l_rs - M_uf*l_fs)/M;

% Longitudinal distance from total CG to front axle
l_f = l_fs + l_cgs;
% Longitudinal distance from total CG to rear axle
l_r = l_rs - l_cgs;

% Front/rear vehicle static axle mass
M_f = M*l_r/L;
M_r = M*l_f/L;

% Height of sprung mass CG above roll center (height of roll center origin)
h_o = h_f + l_f*(h_r - h_f)/L;

% Height of sprung mass CG above the origin
h_s = h_cgs - h_o;

% Height of front/rear unsprung mass above the origin
h_uf = h_cguf - h_o;
h_ur = h_cgur - h_o;

% Height of total vehicle CG
h_cg = (M_s*h_cgs + M_uf*h_cguf + M_ur*h_cgur)/M;

% Chassis Inertial Tensor
I_body = [I_xxs+M_s*h_s^2,I_xys,I_xzs+M_s*h_s*l_cgs;...
       I_xys,I_yys+M_s*(h_s^2+l_cgs^2),I_yzs;...
       I_xzs+M_s*h_s*l_cgs,I_yzs,I_zzs+M_s*l_cgs^2];
   
I_zzus = M_uf*l_f^2 + ...
         M_ur*l_r^2 + ...
         I_zzuf + I_zzur;
 

I_xxo = I_body(1,1);
I_zzo = I_body(3,3) + I_zzus;

% Tire vertical forces
Fz_f = l_r*M*g/(2*L);
Fz_r = l_f*M*g/(2*L);

% Linearized cornering coefficients
C_af = vary(2,2)/vary(2,1)*Fz_f;
C_ar = vary(2,2)/vary(2,1)*Fz_r;

    
%-------------------
%EQUATIONS OF MOTION
%-------------------


% constant EoM parameters
A1 = M_s*h_s/M;
A2 = 1/M;
A3 = -2*M_s*h_s/M;

B1 = -M_s/M;
B2 = 1/M;
B3 = -M_s*h_s/M;
B4 = -M_s*h_s/M;

C1 = (I_xzs-M_s*h_s*l_cgs)/(I_xxs+M_s*h_s^2);
C2 = 1/(I_xxs+M_s*h_s^2);
C3 = (I_xzs-M_s*h_s*l_cgs)/(I_xxs+M_s*h_s^2);
C4 = (I_zzs-I_yys-M_s*h_s^2)/(I_xxs+M_s*h_s^2);

D1 = (I_xzs-M_s*h_s*l_cgs)/I_zzo;
D2 = M_s*h_s/I_zzo;
D3 = 1/I_zzo;
D4 = -(I_xzs - M_s*h_s*l_cgs)/I_zzo;
D5 = -(I_xzs-M_s*h_s*l_cgs)/I_zzo;
D6 = -(I_xzs - M_s*h_s*l_cgs)/I_zzo;

A_kt =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               tau*(((C1*D1*cos(phi)^2 - 1)*(psi_d + A2*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D3*sin(phi)*(l_f*((C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)) + 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -tau*((A2*(C1*D1*cos(phi)^2 - 1)*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D3*sin(phi)*(l_f*((C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                    tau*((A1*sin(phi)*(2*D5*phi_d*sin(phi) + D4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A3*psi_d*cos(phi)*(C1*D1*cos(phi)^2 - 1))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D1*cos(phi)*sin(phi)*(C2*(B_phif + B_phir) - C3*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tau*((A1*sin(phi)*(D5*phi_d^2*cos(phi) + D4*phi_d*psi_d*cos(phi)^2 - D4*phi_d*psi_d*sin(phi)^2 + D6*psi_d^2*cos(phi)^2 - D6*psi_d^2*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*cos(phi)*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - ((C1*D1*cos(phi)^2 - 1)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 - (A1*D1*cos(phi)^2*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D1*sin(phi)^2*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A1*sin(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 - (2*C1*D1*cos(phi)*sin(phi)*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D1*cos(phi)*sin(phi)*(C2*(K_phif + K_phir + M_s*g*h_s*cos(phi)) - C4*psi_d^2*cos(phi)^2 + C4*psi_d^2*sin(phi)^2 - C3*phi_d*psi_d*cos(phi)^2 + C3*phi_d*psi_d*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A3*phi_d*psi_d*sin(phi)*(C1*D1*cos(phi)^2 - 1))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*D1*cos(phi)*sin(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tau*(((C1*D1*cos(phi)^2 - 1)*(x_d + A2*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + A3*phi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A1*sin(phi)*(D4*phi_d*cos(phi)*sin(phi) - D3*(l_f*((C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 + l_r*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))) + 2*D6*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A1*D1*cos(phi)*sin(phi)*(C3*phi_d*cos(phi)*sin(phi) + 2*C4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), 0
        tau*(B2*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) - (B1*C1*D3*cos(phi)^2*(l_f*((C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*C1*D2*cos(phi)^2*sin(phi)*(psi_d + A2*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), 1 - tau*(psi_d + B2*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) - (B1*C1*D3*cos(phi)^2*(l_f*((C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A2*B1*C1*D2*cos(phi)^2*sin(phi)*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), tau*(2*B3*phi_d*sin(phi) - (B1*C1*cos(phi)^2*(2*D5*phi_d*sin(phi) + D4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*cos(phi)*(A1*D2*sin(phi)^2 - 1)*(C2*(B_phif + B_phir) - C3*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A3*B1*C1*D2*psi_d*cos(phi)^3*sin(phi))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), tau*(B3*phi_d^2*cos(phi) + B4*psi_d^2*cos(phi) + (B1*cos(phi)*(A1*D2*sin(phi)^2 - 1)*(C2*(K_phif + K_phir + M_s*g*h_s*cos(phi)) - C4*psi_d^2*cos(phi)^2 + C4*psi_d^2*sin(phi)^2 - C3*phi_d*psi_d*cos(phi)^2 + C3*phi_d*psi_d*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*sin(phi)*(A1*D2*sin(phi)^2 - 1)*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (B1*C1*cos(phi)^2*(D5*phi_d^2*cos(phi) + D4*phi_d*psi_d*cos(phi)^2 - D4*phi_d*psi_d*sin(phi)^2 + D6*psi_d^2*cos(phi)^2 - D6*psi_d^2*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*cos(phi)*(A1*D2*sin(phi)^2 - 1)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (2*B1*C1*cos(phi)*sin(phi)*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*C1*cos(phi)^2*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (B1*C1*D2*cos(phi)^3*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (2*B1*C1*D2*cos(phi)*sin(phi)^2*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (2*A1*B1*D2*cos(phi)^2*sin(phi)*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (B1*C1*D2*cos(phi)^2*sin(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 - (A3*B1*C1*D2*phi_d*psi_d*cos(phi)^2*sin(phi)^2)/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), -tau*(y_d - B2*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) - 2*B4*psi_d*sin(phi) + (B1*C1*cos(phi)^2*(D4*phi_d*cos(phi)*sin(phi) - D3*(l_f*((C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 + l_r*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))) + 2*D6*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (B1*cos(phi)*(A1*D2*sin(phi)^2 - 1)*(C3*phi_d*cos(phi)*sin(phi) + 2*C4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (B1*C1*D2*cos(phi)^2*sin(phi)*(x_d + A2*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + A3*phi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 tau*((C1*D3*cos(phi)*(l_f*((C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*D2*cos(phi)*sin(phi)*(psi_d + A2*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             -tau*((C1*D3*cos(phi)*(l_f*((C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A2*C1*D2*cos(phi)*sin(phi)*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                       1 - tau*(((A1*D2*sin(phi)^2 - 1)*(C2*(B_phif + B_phir) - C3*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*cos(phi)*(2*D5*phi_d*sin(phi) + D4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A3*C1*D2*psi_d*cos(phi)^2*sin(phi))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                 -tau*(((A1*D2*sin(phi)^2 - 1)*(C2*(K_phif + K_phir + M_s*g*h_s*cos(phi)) - C4*psi_d^2*cos(phi)^2 + C4*psi_d^2*sin(phi)^2 - C3*phi_d*psi_d*cos(phi)^2 + C3*phi_d*psi_d*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + ((A1*D2*sin(phi)^2 - 1)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (C1*sin(phi)*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*cos(phi)*(D5*phi_d^2*cos(phi) + D4*phi_d*psi_d*cos(phi)^2 - D4*phi_d*psi_d*sin(phi)^2 + D6*psi_d^2*cos(phi)^2 - D6*psi_d^2*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (C1*D2*cos(phi)^2*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*D2*sin(phi)^2*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (C1*cos(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 - (2*A1*D2*cos(phi)*sin(phi)*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*D2*cos(phi)*sin(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 - (A3*C1*D2*phi_d*psi_d*cos(phi)*sin(phi)^2)/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   tau*(((A1*D2*sin(phi)^2 - 1)*(C3*phi_d*cos(phi)*sin(phi) + 2*C4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (C1*cos(phi)*(D4*phi_d*cos(phi)*sin(phi) - D3*(l_f*((C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 + l_r*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))) + 2*D6*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (C1*D2*cos(phi)*sin(phi)*(x_d + A2*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + A3*phi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)), 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                  tau,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0, 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -tau*((D3*(l_f*((C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (D2*sin(phi)*(psi_d + A2*((C_ar*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (cos(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(sin(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (cos(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      tau*((D3*(l_f*((C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 - l_r*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A2*D2*sin(phi)*((C_ar*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (sin(delta)*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*(cos(delta)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (sin(delta)*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                        -tau*((2*D5*phi_d*sin(phi) + D4*psi_d*cos(phi)*sin(phi))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (D1*cos(phi)*(C2*(B_phif + B_phir) - C3*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A3*D2*psi_d*cos(phi)*sin(phi))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -tau*((D5*phi_d^2*cos(phi) + D4*phi_d*psi_d*cos(phi)^2 - D4*phi_d*psi_d*sin(phi)^2 + D6*psi_d^2*cos(phi)^2 - D6*psi_d^2*sin(phi)^2)/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - ((2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(D5*phi_d^2*sin(phi) - D3*((t_f*(C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 - l_r*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)))) + l_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))) + D6*psi_d^2*cos(phi)*sin(phi) + D4*phi_d*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (D1*sin(phi)*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (D2*cos(phi)*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (D1*cos(phi)*(C2*(K_phif + K_phir + M_s*g*h_s*cos(phi)) - C4*psi_d^2*cos(phi)^2 + C4*psi_d^2*sin(phi)^2 - C3*phi_d*psi_d*cos(phi)^2 + C3*phi_d*psi_d*sin(phi)^2))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (D2*sin(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(psi_d*x_d - A2*(C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_ar*atan((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + A3*phi_d*psi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (D1*cos(phi)*(2*A1*D2*cos(phi)*sin(phi) - 2*C1*D1*cos(phi)*sin(phi))*(C4*cos(phi)*sin(phi)*psi_d^2 + C3*phi_d*cos(phi)*sin(phi)*psi_d - C2*(B_phif*phi_d + B_phir*phi_d + K_phif*phi + K_phir*phi + M_s*g*h_s*sin(phi))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)^2 + (A3*D2*phi_d*psi_d*sin(phi)^2)/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    tau*((D1*cos(phi)*(C3*phi_d*cos(phi)*sin(phi) + 2*C4*psi_d*cos(phi)*sin(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (D4*phi_d*cos(phi)*sin(phi) - D3*(l_f*((C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) + (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + (t_f*((C_af*sin(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*sin(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)))/2 + l_r*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1))) + 2*D6*psi_d*cos(phi)*sin(phi))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (D2*sin(phi)*(x_d + A2*((C_ar*((l_r*cos(delta) - (t_r*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) - (((t_r*cos(delta))/2 + l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2)))/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d - (psi_d*t_r)/2))^2/(cos(delta)*(x_d - (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) + (C_ar*((l_r*cos(delta) + (t_r*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d)) + (((t_r*cos(delta))/2 - l_r*sin(delta))*(cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2)))/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2))/((cos(delta)*(y_d - l_r*psi_d) - sin(delta)*(x_d + (psi_d*t_r)/2))^2/(cos(delta)*(x_d + (psi_d*t_r)/2) + sin(delta)*(y_d - l_r*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) + (t_f*sin(delta))/2)/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) + (((t_f*cos(delta))/2 - l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2)))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))^2/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1) - (C_af*cos(delta)*((l_f*cos(delta) - (t_f*sin(delta))/2)/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)) - (((t_f*cos(delta))/2 + l_f*sin(delta))*(cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2)))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2))/((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))^2/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))^2 + 1)) + A3*phi_d*cos(phi)))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1)) + 1, 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            0,                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      tau, 1]
 
 
B_kt = [tau*((A2*(C1*D1*cos(phi)^2 - 1)*(2*C_ar + 2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) - (A1*D3*sin(phi)*((t_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 + 2*C_ar*l_r - l_f*(2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1))
        tau*(B2*(2*C_ar + 2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))) + (B1*C1*D3*cos(phi)^2*((t_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 + 2*C_ar*l_r - l_f*(2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A2*B1*C1*D2*cos(phi)^2*sin(phi)*(2*C_ar + 2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1))
        -tau*((C1*D3*cos(phi)*((t_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 + 2*C_ar*l_r - l_f*(2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A2*C1*D2*cos(phi)*sin(phi)*(2*C_ar + 2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1))
        0
        tau*((D3*((t_f*(C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) - C_af*cos(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/2 + 2*C_ar*l_r - l_f*(2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1) + (A2*D2*sin(phi)*(2*C_ar + 2*C_af*cos(delta) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d - (psi_d*t_f)/2))/(cos(delta)*(x_d - (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d))) + C_af*sin(delta)*atan((cos(delta)*(y_d + l_f*psi_d) - sin(delta)*(x_d + (psi_d*t_f)/2))/(cos(delta)*(x_d + (psi_d*t_f)/2) + sin(delta)*(y_d + l_f*psi_d)))))/(C1*D1*cos(phi)^2 + A1*D2*sin(phi)^2 - 1))
        0]
 



% % solve for the initial state trajectory
% E_k1 = get_next_step(F_Ed, E, initial_state);
% 
% for time = 0.0: tau: 1.0
%     E_k = E_k1;
%     E_k1 = get_next_step(F_Ed, E, E_k);
% end

%------------- END OF CODE --------------
